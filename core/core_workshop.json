{
  "pack_id": "core.workshop",
  "name": "Workshop",
  "version": 1,
  "author": "Djih",

  "facilities": [
    {
      "id": "core.workshop:workshop:t1",
      "name": "Workshop",
      "description": "A basic crafting space for creating and repairing equipment.",
      "tier": 1,
      "parent": null,
      "build": {
        "cost": {"gold": 250},
        "duration_turns": 1
      },
      "npc_slots": 1,
      "npc_allowed_professions": ["craftsman", "blacksmith", "carpenter", "leatherworker"],
      "npc_base_upkeep": {"silver": 5},

      "orders": [
        {
          "id": "craft_simple_weapon",
          "name": "Craft Simple Weapon",
          "description": "Forge a basic weapon like a dagger or club.",
          "min_npc_level": 1,
          "duration_turns": 1,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -1},
                {"item": "simple_weapon", "qty": 1},
                {"log": "Simple weapon crafted successfully."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -1},
                {"item": "quality_weapon", "qty": 1},
                {"log": "Exceptional craftsmanship! Created a quality weapon."}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "iron_ingot", "qty": -1},
                {"item": "scrap_metal", "qty": 1},
                {"log": "Crafting attempt failed. Materials wasted."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "iron_ingot", "qty": -1},
                {"gold": -5},
                {"log": "Critical failure! Tool damage requires repairs."}
              ]
            }
          }
        },
        {
          "id": "repair_equipment",
          "name": "Repair Equipment",
          "description": "Fix damaged weapons, armor, or tools.",
          "min_npc_level": 1,
          "duration_turns": 1,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "damaged_equipment", "qty": -1},
                {"item": "repaired_equipment", "qty": 1},
                {"gold": 10},
                {"log": "Equipment repaired and customer paid."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "damaged_equipment", "qty": -1},
                {"item": "improved_equipment", "qty": 1},
                {"gold": 25},
                {"log": "Not only repaired but improved! Customer very pleased."}
              ]
            },
            "on_failure": {
              "effects": [
                {"log": "No repair jobs this week."}
              ]
            }
          }
        },
        {
          "id": "craft_armor",
          "name": "Craft Armor",
          "description": "Create basic armor pieces.",
          "min_npc_level": 2,
          "duration_turns": 2,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "leather", "qty": -2},
                {"item": "chainmail", "qty": 1},
                {"log": "Chainmail armor completed."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "leather", "qty": -2},
                {"item": "masterwork_chainmail", "qty": 1},
                {"log": "Masterwork armor! Superior protection."}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "leather", "qty": -2},
                {"item": "flawed_armor", "qty": 1},
                {"log": "Armor completed but has flaws."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "leather", "qty": -2},
                {"log": "Crafting disaster! All materials lost."}
              ]
            }
          }
        },
        {
          "id": "experiment_technique",
          "name": "Experiment with Technique",
          "description": "Try new crafting methods to discover improvements.",
          "min_npc_level": 1,
          "duration_turns": 1,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"log": "Learned a useful technique."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "crafting_notes", "qty": 1},
                {"log": "Major discovery! Documented new technique."}
              ]
            },
            "on_failure": {
              "effects": [
                {"log": "Experiments yielded no results."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"gold": -10},
                {"log": "Experiment went wrong! Small workshop fire."}
              ]
            }
          }
        }
      ]
    },

    {
      "id": "core.workshop:workshop:t2",
      "name": "Advanced Workshop",
      "description": "An upgraded workshop with superior tools and workspace for masterwork creations.",
      "tier": 2,
      "parent": "core.workshop:workshop:t1",
      "build": {
        "cost": {"gold": 500},
        "duration_turns": 2
      },
      "npc_slots": 2,
      "npc_allowed_professions": ["craftsman", "blacksmith", "carpenter", "leatherworker", "artificer"],
      "npc_base_upkeep": {"silver": 10},

      "orders": [
        {
          "id": "craft_masterwork_weapon",
          "name": "Craft Masterwork Weapon",
          "description": "Forge a superior quality weapon with enhanced properties.",
          "min_npc_level": 2,
          "duration_turns": 2,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "steel_ingot", "qty": -2},
                {"item": "rare_wood", "qty": -1},
                {"item": "masterwork_longsword", "qty": 1},
                {"gold": 50},
                {"log": "Masterwork longsword completed and sold."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "steel_ingot", "qty": -2},
                {"item": "rare_wood", "qty": -1},
                {"item": "legendary_longsword", "qty": 1},
                {"gold": 150},
                {"log": "A legendary blade! Word of this craftsmanship spreads far."}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "steel_ingot", "qty": -2},
                {"item": "rare_wood", "qty": -1},
                {"item": "quality_weapon", "qty": 1},
                {"log": "Weapon is good, but not masterwork quality."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "steel_ingot", "qty": -2},
                {"item": "rare_wood", "qty": -1},
                {"log": "The blade shattered during tempering!"}
              ]
            }
          }
        },
        {
          "id": "craft_magical_item",
          "name": "Craft Magical Item",
          "description": "Imbue an item with minor magical properties.",
          "min_npc_level": 3,
          "duration_turns": 3,
          "outcome": {
            "check_profile": "d20_hard",
            "on_success": {
              "effects": [
                {"item": "enchanted_gem", "qty": -1},
                {"item": "mithril_ingot", "qty": -1},
                {"item": "magic_ring", "qty": 1},
                {"log": "Successfully crafted a magic ring."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "enchanted_gem", "qty": -1},
                {"item": "mithril_ingot", "qty": -1},
                {"item": "powerful_magic_ring", "qty": 1},
                {"log": "The enchantment exceeded expectations! A powerful artifact."}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "enchanted_gem", "qty": -1},
                {"item": "mithril_ingot", "qty": -1},
                {"item": "flawed_magic_item", "qty": 1},
                {"log": "The enchantment is unstable."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "enchanted_gem", "qty": -1},
                {"item": "mithril_ingot", "qty": -1},
                {"gold": -30},
                {"log": "Magical explosion! Workshop damage and materials lost."}
              ]
            }
          }
        },
        {
          "id": "mass_production",
          "name": "Mass Production",
          "description": "Produce multiple simple items efficiently.",
          "min_npc_level": 2,
          "duration_turns": 1,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "simple_weapon", "qty": 5},
                {"gold": 25},
                {"log": "Batch production successful. Items sold."}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "simple_weapon", "qty": 7},
                {"gold": 40},
                {"log": "Exceptionally efficient production!"}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "iron_ingot", "qty": -3},
                {"item": "simple_weapon", "qty": 3},
                {"log": "Production below target."}
              ]
            }
          }
        },
        {
          "id": "reverse_engineer",
          "name": "Reverse Engineer Item",
          "description": "Study and learn from an existing magical or complex item.",
          "min_npc_level": 3,
          "duration_turns": 2,
          "outcome": {
            "check_profile": "d20",
            "on_success": {
              "effects": [
                {"item": "mystery_item", "qty": -1},
                {"item": "crafting_blueprint", "qty": 1},
                {"log": "Successfully reverse engineered the item!"}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "mystery_item", "qty": -1},
                {"item": "crafting_blueprint", "qty": 1},
                {"item": "mystery_item", "qty": 1},
                {"log": "Learned the secret AND kept the item intact!"}
              ]
            },
            "on_failure": {
              "effects": [
                {"log": "Unable to discern the item's secrets."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "mystery_item", "qty": -1},
                {"log": "The item was destroyed in the process!"}
              ]
            }
          }
        }
      ]
    },

    {
      "id": "core.workshop:workshop:t3",
      "name": "Master Forge",
      "description": "A legendary workshop capable of creating artifacts and enchanted equipment.",
      "tier": 3,
      "parent": "core.workshop:workshop:t2",
      "build": {
        "cost": {"gold": 1000},
        "duration_turns": 3
      },
      "npc_slots": 3,
      "npc_allowed_professions": ["craftsman", "blacksmith", "artificer", "enchanter"],
      "npc_base_upkeep": {"gold": 1},

      "orders": [
        {
          "id": "forge_artifact",
          "name": "Forge Artifact",
          "description": "Attempt to create a legendary artifact of immense power.",
          "min_npc_level": 3,
          "duration_turns": 8,
          "outcome": {
            "check_profile": "d20_hard",
            "on_success": {
              "effects": [
                {"item": "adamantine_ingot", "qty": -5},
                {"item": "dragon_scale", "qty": -3},
                {"item": "celestial_essence", "qty": -1},
                {"item": "legendary_artifact", "qty": 1},
                {"log": "A legendary artifact has been forged!"}
              ]
            },
            "on_critical_success": {
              "effects": [
                {"item": "adamantine_ingot", "qty": -5},
                {"item": "dragon_scale", "qty": -3},
                {"item": "celestial_essence", "qty": -1},
                {"item": "artifact_of_legend", "qty": 1},
                {"log": "The artifact resonates with divine power! Songs will be sung of this creation."}
              ]
            },
            "on_failure": {
              "effects": [
                {"item": "adamantine_ingot", "qty": -5},
                {"item": "dragon_scale", "qty": -3},
                {"item": "celestial_essence", "qty": -1},
                {"item": "flawed_artifact", "qty": 1},
                {"log": "The artifact has power, but is unstable."}
              ]
            },
            "on_critical_failure": {
              "effects": [
                {"item": "adamantine_ingot", "qty": -5},
                {"item": "dragon_scale", "qty": -3},
                {"item": "celestial_essence", "qty": -1},
                {"gold": -100},
                {"log": "Catastrophic failure! The forge itself was damaged by the released energies."}
              ]
            }
          }
        }
      ]
    }
  ]
}